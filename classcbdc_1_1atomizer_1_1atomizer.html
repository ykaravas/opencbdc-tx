<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>OpenCBDC Transaction Processor: cbdc::atomizer::atomizer Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">OpenCBDC Transaction Processor
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('classcbdc_1_1atomizer_1_1atomizer.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a>  </div>
  <div class="headertitle"><div class="title">cbdc::atomizer::atomizer Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Atomizer implementation.  
 <a href="classcbdc_1_1atomizer_1_1atomizer.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="atomizer_8hpp_source.html">atomizer.hpp</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a97cb76531b56b6063a580e580684e8af"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcbdc_1_1atomizer_1_1atomizer.html#a97cb76531b56b6063a580e580684e8af">atomizer</a> (uint64_t best_height, size_t stxo_cache_depth)</td></tr>
<tr class="memdesc:a97cb76531b56b6063a580e580684e8af"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="classcbdc_1_1atomizer_1_1atomizer.html#a97cb76531b56b6063a580e580684e8af">More...</a><br /></td></tr>
<tr class="separator:a97cb76531b56b6063a580e580684e8af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16472f11cee6fa531529b0e5383c2ed0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcbdc_1_1atomizer_1_1atomizer.html#a16472f11cee6fa531529b0e5383c2ed0">~atomizer</a> ()=default</td></tr>
<tr class="separator:a16472f11cee6fa531529b0e5383c2ed0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f736f05bd342e2373e06c637d153fb9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcbdc_1_1atomizer_1_1atomizer.html#a8f736f05bd342e2373e06c637d153fb9">atomizer</a> ()=delete</td></tr>
<tr class="separator:a8f736f05bd342e2373e06c637d153fb9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3fbaf4773edf9c9cea54d79568596728"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcbdc_1_1atomizer_1_1atomizer.html#a3fbaf4773edf9c9cea54d79568596728">atomizer</a> (const <a class="el" href="classcbdc_1_1atomizer_1_1atomizer.html">atomizer</a> &amp;)=delete</td></tr>
<tr class="separator:a3fbaf4773edf9c9cea54d79568596728"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e629074680d1b9e9d387d37a86d04e2"><td class="memItemLeft" align="right" valign="top">auto&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcbdc_1_1atomizer_1_1atomizer.html#a2e629074680d1b9e9d387d37a86d04e2">operator=</a> (const <a class="el" href="classcbdc_1_1atomizer_1_1atomizer.html">atomizer</a> &amp;) -&gt; <a class="el" href="classcbdc_1_1atomizer_1_1atomizer.html">atomizer</a> &amp;=delete</td></tr>
<tr class="separator:a2e629074680d1b9e9d387d37a86d04e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a110b46b1a2319903aff831318fd868e7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcbdc_1_1atomizer_1_1atomizer.html#a110b46b1a2319903aff831318fd868e7">atomizer</a> (<a class="el" href="classcbdc_1_1atomizer_1_1atomizer.html">atomizer</a> &amp;&amp;)=delete</td></tr>
<tr class="separator:a110b46b1a2319903aff831318fd868e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab5d1dd0c4e0ea932dbcbf8cd65d19ea3"><td class="memItemLeft" align="right" valign="top">auto&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcbdc_1_1atomizer_1_1atomizer.html#ab5d1dd0c4e0ea932dbcbf8cd65d19ea3">operator=</a> (<a class="el" href="classcbdc_1_1atomizer_1_1atomizer.html">atomizer</a> &amp;&amp;) -&gt; <a class="el" href="classcbdc_1_1atomizer_1_1atomizer.html">atomizer</a> &amp;=delete</td></tr>
<tr class="separator:ab5d1dd0c4e0ea932dbcbf8cd65d19ea3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a8972935b1b41827ce3bc3014646f1f"><td class="memItemLeft" align="right" valign="top">auto&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcbdc_1_1atomizer_1_1atomizer.html#a5a8972935b1b41827ce3bc3014646f1f">insert</a> (uint64_t block_height, <a class="el" href="structcbdc_1_1transaction_1_1compact__tx.html">transaction::compact_tx</a> tx, std::unordered_set&lt; uint32_t &gt; attestations) -&gt; std::optional&lt; <a class="el" href="classcbdc_1_1watchtower_1_1tx__error.html">watchtower::tx_error</a> &gt;</td></tr>
<tr class="memdesc:a5a8972935b1b41827ce3bc3014646f1f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Attempts to add the specified shard attestations for a specified transaction at or later than the specified block height.  <a href="classcbdc_1_1atomizer_1_1atomizer.html#a5a8972935b1b41827ce3bc3014646f1f">More...</a><br /></td></tr>
<tr class="separator:a5a8972935b1b41827ce3bc3014646f1f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada1c32ec7d20f4ff7cefecb5f09b08fd"><td class="memItemLeft" align="right" valign="top">auto&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcbdc_1_1atomizer_1_1atomizer.html#ada1c32ec7d20f4ff7cefecb5f09b08fd">insert_complete</a> (uint64_t oldest_attestation, <a class="el" href="structcbdc_1_1transaction_1_1compact__tx.html">transaction::compact_tx</a> &amp;&amp;tx) -&gt; std::optional&lt; <a class="el" href="classcbdc_1_1watchtower_1_1tx__error.html">watchtower::tx_error</a> &gt;</td></tr>
<tr class="memdesc:ada1c32ec7d20f4ff7cefecb5f09b08fd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Attempts to add the given compact transaction to the list of complete transactions pending for inclusion in the next block.  <a href="classcbdc_1_1atomizer_1_1atomizer.html#ada1c32ec7d20f4ff7cefecb5f09b08fd">More...</a><br /></td></tr>
<tr class="separator:ada1c32ec7d20f4ff7cefecb5f09b08fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7f5837f51166b54e40a683e00248aab"><td class="memItemLeft" align="right" valign="top">auto&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcbdc_1_1atomizer_1_1atomizer.html#ac7f5837f51166b54e40a683e00248aab">make_block</a> () -&gt; std::pair&lt; <a class="el" href="structcbdc_1_1atomizer_1_1block.html">cbdc::atomizer::block</a>, std::vector&lt; <a class="el" href="classcbdc_1_1watchtower_1_1tx__error.html">watchtower::tx_error</a> &gt; &gt;</td></tr>
<tr class="memdesc:ac7f5837f51166b54e40a683e00248aab"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds the current set of complete transactions to a new block and returns it for storage and transmission to subscribers.  <a href="classcbdc_1_1atomizer_1_1atomizer.html#ac7f5837f51166b54e40a683e00248aab">More...</a><br /></td></tr>
<tr class="separator:ac7f5837f51166b54e40a683e00248aab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a520004b626c068bb55a8fd4d140978e9"><td class="memItemLeft" align="right" valign="top">auto&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcbdc_1_1atomizer_1_1atomizer.html#a520004b626c068bb55a8fd4d140978e9">pending_transactions</a> () const -&gt; size_t</td></tr>
<tr class="memdesc:a520004b626c068bb55a8fd4d140978e9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the number of complete transactions waiting to be included in the next block.  <a href="classcbdc_1_1atomizer_1_1atomizer.html#a520004b626c068bb55a8fd4d140978e9">More...</a><br /></td></tr>
<tr class="separator:a520004b626c068bb55a8fd4d140978e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9858af0746fb1a2e3d44298b3f3d46f9"><td class="memItemLeft" align="right" valign="top">auto&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcbdc_1_1atomizer_1_1atomizer.html#a9858af0746fb1a2e3d44298b3f3d46f9">height</a> () const -&gt; uint64_t</td></tr>
<tr class="memdesc:a9858af0746fb1a2e3d44298b3f3d46f9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the height of the most recent block.  <a href="classcbdc_1_1atomizer_1_1atomizer.html#a9858af0746fb1a2e3d44298b3f3d46f9">More...</a><br /></td></tr>
<tr class="separator:a9858af0746fb1a2e3d44298b3f3d46f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb13e49796686aa45107f40a6da122ac"><td class="memItemLeft" align="right" valign="top">auto&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcbdc_1_1atomizer_1_1atomizer.html#abb13e49796686aa45107f40a6da122ac">serialize</a> () -&gt; <a class="el" href="classcbdc_1_1buffer.html">buffer</a></td></tr>
<tr class="memdesc:abb13e49796686aa45107f40a6da122ac"><td class="mdescLeft">&#160;</td><td class="mdescRight">Serializes the internal state of the atomizer into a buffer.  <a href="classcbdc_1_1atomizer_1_1atomizer.html#abb13e49796686aa45107f40a6da122ac">More...</a><br /></td></tr>
<tr class="separator:abb13e49796686aa45107f40a6da122ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5a90e73fa482ad54131d373f0989ec6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcbdc_1_1atomizer_1_1atomizer.html#ac5a90e73fa482ad54131d373f0989ec6">deserialize</a> (<a class="el" href="classcbdc_1_1serializer.html">serializer</a> &amp;buf)</td></tr>
<tr class="memdesc:ac5a90e73fa482ad54131d373f0989ec6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Replaces the state of this atomizer instance with the provided serialized state data.  <a href="classcbdc_1_1atomizer_1_1atomizer.html#ac5a90e73fa482ad54131d373f0989ec6">More...</a><br /></td></tr>
<tr class="separator:ac5a90e73fa482ad54131d373f0989ec6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a378f7824083d84f56176f120c6803138"><td class="memItemLeft" align="right" valign="top">auto&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcbdc_1_1atomizer_1_1atomizer.html#a378f7824083d84f56176f120c6803138">operator==</a> (const <a class="el" href="classcbdc_1_1atomizer_1_1atomizer.html">atomizer</a> &amp;other) const -&gt; bool</td></tr>
<tr class="separator:a378f7824083d84f56176f120c6803138"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >Atomizer implementation. </p>
<p >Aggregates transaction notifications and input attestations. Accepts transactions with a full set of attestations, and provides block construction functionality. Keeps track of recently spent UHS IDs and the block height at which they were spent to enable input attestations that are not valid as of the most recent block height to still be used. This works because inputs covered by attestations with a block height lower than the most recent block will be in the spent cache if they are unspendable. Otherwise, the atomizer can be certain the inputs not have been spent. </p><dl class="section warning"><dt>Warning</dt><dd>Not thread-safe. Does not persist the atomizer internal state. </dd></dl>

<p class="definition">Definition at line <a class="el" href="atomizer_8hpp_source.html#l00032">32</a> of file <a class="el" href="atomizer_8hpp_source.html">atomizer.hpp</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a97cb76531b56b6063a580e580684e8af" name="a97cb76531b56b6063a580e580684e8af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a97cb76531b56b6063a580e580684e8af">&#9670;&nbsp;</a></span>atomizer() <span class="overload">[1/4]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">cbdc::atomizer::atomizer::atomizer </td>
          <td>(</td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>best_height</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>stxo_cache_depth</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">best_height</td><td>starting block height. </td></tr>
    <tr><td class="paramname">stxo_cache_depth</td><td>maximum number of recent blocks over which to maintain the spent UHS IDs cache. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="atomizer_8cpp_source.html#l00166">166</a> of file <a class="el" href="atomizer_8cpp_source.html">atomizer.cpp</a>.</p>

</div>
</div>
<a id="a16472f11cee6fa531529b0e5383c2ed0" name="a16472f11cee6fa531529b0e5383c2ed0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a16472f11cee6fa531529b0e5383c2ed0">&#9670;&nbsp;</a></span>~atomizer()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">cbdc::atomizer::atomizer::~atomizer </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">default</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a8f736f05bd342e2373e06c637d153fb9" name="a8f736f05bd342e2373e06c637d153fb9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8f736f05bd342e2373e06c637d153fb9">&#9670;&nbsp;</a></span>atomizer() <span class="overload">[2/4]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">cbdc::atomizer::atomizer::atomizer </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">delete</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a3fbaf4773edf9c9cea54d79568596728" name="a3fbaf4773edf9c9cea54d79568596728"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3fbaf4773edf9c9cea54d79568596728">&#9670;&nbsp;</a></span>atomizer() <span class="overload">[3/4]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">cbdc::atomizer::atomizer::atomizer </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classcbdc_1_1atomizer_1_1atomizer.html">atomizer</a> &amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">delete</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a110b46b1a2319903aff831318fd868e7" name="a110b46b1a2319903aff831318fd868e7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a110b46b1a2319903aff831318fd868e7">&#9670;&nbsp;</a></span>atomizer() <span class="overload">[4/4]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">cbdc::atomizer::atomizer::atomizer </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classcbdc_1_1atomizer_1_1atomizer.html">atomizer</a> &amp;&amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">delete</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="ac5a90e73fa482ad54131d373f0989ec6" name="ac5a90e73fa482ad54131d373f0989ec6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac5a90e73fa482ad54131d373f0989ec6">&#9670;&nbsp;</a></span>deserialize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cbdc::atomizer::atomizer::deserialize </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classcbdc_1_1serializer.html">cbdc::serializer</a> &amp;&#160;</td>
          <td class="paramname"><em>buf</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Replaces the state of this atomizer instance with the provided serialized state data. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">buf</td><td>serialized atomizer state produced with <a class="el" href="classcbdc_1_1atomizer_1_1atomizer.html#abb13e49796686aa45107f40a6da122ac">serialize</a>. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="atomizer_8cpp_source.html#l00184">184</a> of file <a class="el" href="atomizer_8cpp_source.html">atomizer.cpp</a>.</p>

</div>
</div>
<a id="a9858af0746fb1a2e3d44298b3f3d46f9" name="a9858af0746fb1a2e3d44298b3f3d46f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9858af0746fb1a2e3d44298b3f3d46f9">&#9670;&nbsp;</a></span>height()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">auto cbdc::atomizer::atomizer::height </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const -&gt; uint64_t</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the height of the most recent block. </p>
<dl class="section return"><dt>Returns</dt><dd>block height. </dd></dl>

<p class="definition">Definition at line <a class="el" href="atomizer_8cpp_source.html#l00162">162</a> of file <a class="el" href="atomizer_8cpp_source.html">atomizer.cpp</a>.</p>

</div>
</div>
<a id="a5a8972935b1b41827ce3bc3014646f1f" name="a5a8972935b1b41827ce3bc3014646f1f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5a8972935b1b41827ce3bc3014646f1f">&#9670;&nbsp;</a></span>insert()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">auto cbdc::atomizer::atomizer::insert </td>
          <td>(</td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>block_height</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcbdc_1_1transaction_1_1compact__tx.html">transaction::compact_tx</a>&#160;</td>
          <td class="paramname"><em>tx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::unordered_set&lt; uint32_t &gt;&#160;</td>
          <td class="paramname"><em>attestations</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> -&gt; std::optional&lt;<a class="el" href="classcbdc_1_1watchtower_1_1tx__error.html">watchtower::tx_error</a>&gt;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Attempts to add the specified shard attestations for a specified transaction at or later than the specified block height. </p>
<p >Creates a new pending transaction if necessary. If the provided transaction is already pending, merges the new attestations. Returns an error to forward to the watchtower if:</p><ul>
<li>The block height is below the lower limit of the STXO cache.</li>
<li>The STXO cache contains one of the transaction's inputs (double spend). <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">block_height</td><td>the block height at which the shard provided the attestations. </td></tr>
    <tr><td class="paramname">tx</td><td>the complete transaction. </td></tr>
    <tr><td class="paramname">attestations</td><td>a set of the input indices to which the shard attested the validity. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>an error to forward to the watchtower, if necessary. </dd></dl>
</li>
</ul>

<p class="definition">Definition at line <a class="el" href="atomizer_8cpp_source.html#l00044">44</a> of file <a class="el" href="atomizer_8cpp_source.html">atomizer.cpp</a>.</p>

</div>
</div>
<a id="ada1c32ec7d20f4ff7cefecb5f09b08fd" name="ada1c32ec7d20f4ff7cefecb5f09b08fd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ada1c32ec7d20f4ff7cefecb5f09b08fd">&#9670;&nbsp;</a></span>insert_complete()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">auto cbdc::atomizer::atomizer::insert_complete </td>
          <td>(</td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>oldest_attestation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcbdc_1_1transaction_1_1compact__tx.html">transaction::compact_tx</a> &amp;&amp;&#160;</td>
          <td class="paramname"><em>tx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> -&gt; std::optional&lt;<a class="el" href="classcbdc_1_1watchtower_1_1tx__error.html">watchtower::tx_error</a>&gt;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Attempts to add the given compact transaction to the list of complete transactions pending for inclusion in the next block. </p>
<p >If the block height of the oldest attestation in the transaction precedes the height of the earliest block in the spent UHS ID cache, discards the transaction and returns a watchtower error. If the compact transaction attempts to spend a UHS ID matching one in the spent UHS ID cache, discards the compact TX and returns a watchtower error. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">oldest_attestation</td><td>block height of the oldest shard attestation in the notification. </td></tr>
    <tr><td class="paramname">tx</td><td>compact transaction to insert in the next block. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>std::nullopt if the operation successfully inserted the transaction into the next block, or the relevant watchtower error on failure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="atomizer_8cpp_source.html#l00134">134</a> of file <a class="el" href="atomizer_8cpp_source.html">atomizer.cpp</a>.</p>

</div>
</div>
<a id="ac7f5837f51166b54e40a683e00248aab" name="ac7f5837f51166b54e40a683e00248aab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac7f5837f51166b54e40a683e00248aab">&#9670;&nbsp;</a></span>make_block()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">auto cbdc::atomizer::atomizer::make_block </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> -&gt; std::pair&lt;<a class="el" href="structcbdc_1_1atomizer_1_1block.html">cbdc::atomizer::block</a>,
                         std::vector&lt;<a class="el" href="classcbdc_1_1watchtower_1_1tx__error.html">watchtower::tx_error</a>&gt;&gt;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adds the current set of complete transactions to a new block and returns it for storage and transmission to subscribers. </p>
<p >Rotates the STXO cache, evicting the oldest set of transactions. Generates and returns a set of errors containing an error for each incomplete transaction in the set of evicted transactions, or an empty vector if there are no such errors. </p><dl class="section return"><dt>Returns</dt><dd>a pair containing the resultant block and errors to forward to the watchtower if necessary. </dd></dl>

<p class="definition">Definition at line <a class="el" href="atomizer_8cpp_source.html#l00014">14</a> of file <a class="el" href="atomizer_8cpp_source.html">atomizer.cpp</a>.</p>

<p class="reference">References <a class="el" href="block_8hpp_source.html#l00024">cbdc::atomizer::block::m_height</a>, and <a class="el" href="block_8hpp_source.html#l00026">cbdc::atomizer::block::m_transactions</a>.</p>

</div>
</div>
<a id="ab5d1dd0c4e0ea932dbcbf8cd65d19ea3" name="ab5d1dd0c4e0ea932dbcbf8cd65d19ea3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab5d1dd0c4e0ea932dbcbf8cd65d19ea3">&#9670;&nbsp;</a></span>operator=() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">auto cbdc::atomizer::atomizer::operator= </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classcbdc_1_1atomizer_1_1atomizer.html">atomizer</a> &amp;&amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td> -&gt;  <a class="el" href="classcbdc_1_1atomizer_1_1atomizer.html">atomizer</a> &amp;=delete</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">delete</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a2e629074680d1b9e9d387d37a86d04e2" name="a2e629074680d1b9e9d387d37a86d04e2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2e629074680d1b9e9d387d37a86d04e2">&#9670;&nbsp;</a></span>operator=() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">auto cbdc::atomizer::atomizer::operator= </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classcbdc_1_1atomizer_1_1atomizer.html">atomizer</a> &amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td> -&gt;  <a class="el" href="classcbdc_1_1atomizer_1_1atomizer.html">atomizer</a> &amp;=delete</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">delete</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a378f7824083d84f56176f120c6803138" name="a378f7824083d84f56176f120c6803138"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a378f7824083d84f56176f120c6803138">&#9670;&nbsp;</a></span>operator==()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">auto cbdc::atomizer::atomizer::operator== </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classcbdc_1_1atomizer_1_1atomizer.html">atomizer</a> &amp;&#160;</td>
          <td class="paramname"><em>other</em></td><td>)</td>
          <td> const -&gt; bool</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="atomizer_8cpp_source.html#l00195">195</a> of file <a class="el" href="atomizer_8cpp_source.html">atomizer.cpp</a>.</p>

</div>
</div>
<a id="a520004b626c068bb55a8fd4d140978e9" name="a520004b626c068bb55a8fd4d140978e9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a520004b626c068bb55a8fd4d140978e9">&#9670;&nbsp;</a></span>pending_transactions()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">auto cbdc::atomizer::atomizer::pending_transactions </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const -&gt; size_t</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the number of complete transactions waiting to be included in the next block. </p>
<dl class="section return"><dt>Returns</dt><dd>number of transactions. </dd></dl>

<p class="definition">Definition at line <a class="el" href="atomizer_8cpp_source.html#l00158">158</a> of file <a class="el" href="atomizer_8cpp_source.html">atomizer.cpp</a>.</p>

</div>
</div>
<a id="abb13e49796686aa45107f40a6da122ac" name="abb13e49796686aa45107f40a6da122ac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb13e49796686aa45107f40a6da122ac">&#9670;&nbsp;</a></span>serialize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">auto cbdc::atomizer::atomizer::serialize </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> -&gt; <a class="el" href="classcbdc_1_1buffer.html">buffer</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Serializes the internal state of the atomizer into a buffer. </p>
<dl class="section return"><dt>Returns</dt><dd>serialized atomizer state. </dd></dl>

<p class="definition">Definition at line <a class="el" href="atomizer_8cpp_source.html#l00174">174</a> of file <a class="el" href="atomizer_8cpp_source.html">atomizer.cpp</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="atomizer_8hpp_source.html">atomizer.hpp</a></li>
<li><a class="el" href="atomizer_8cpp_source.html">atomizer.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacecbdc.html">cbdc</a></li><li class="navelem"><a class="el" href="namespacecbdc_1_1atomizer.html">atomizer</a></li><li class="navelem"><a class="el" href="classcbdc_1_1atomizer_1_1atomizer.html">atomizer</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3 </li>
  </ul>
</div>
</body>
</html>
