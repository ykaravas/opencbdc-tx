<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>OpenCBDC Transaction Processor: cbdc::locking_shard::locking_shard Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">OpenCBDC Transaction Processor
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('classcbdc_1_1locking__shard_1_1locking__shard.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#pub-methods">Public Member Functions</a>  </div>
  <div class="headertitle"><div class="title">cbdc::locking_shard::locking_shard Class Reference<span class="mlabels"><span class="mlabel">final</span></span></div></div>
</div><!--header-->
<div class="contents">

<p>In-memory implementation of <a class="el" href="classcbdc_1_1locking__shard_1_1interface.html">interface</a> and <a class="el" href="classcbdc_1_1locking__shard_1_1status__interface.html">status_interface</a>.  
 <a href="classcbdc_1_1locking__shard_1_1locking__shard.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="locking__shard_8hpp_source.html">locking_shard.hpp</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for cbdc::locking_shard::locking_shard:</div>
<div class="dyncontent">
<div class="center"><img src="classcbdc_1_1locking__shard_1_1locking__shard__inherit__graph.png" border="0" usemap="#acbdc_1_1locking__shard_1_1locking__shard_inherit__map" alt="Inheritance graph"/></div>
<map name="acbdc_1_1locking__shard_1_1locking__shard_inherit__map" id="acbdc_1_1locking__shard_1_1locking__shard_inherit__map">
<area shape="rect" title="In&#45;memory implementation of interface and status_interface." alt="" coords="85,95,221,136"/>
<area shape="rect" href="classcbdc_1_1locking__shard_1_1interface.html" title="Interface for a locking shard." alt="" coords="5,5,141,47"/>
<area shape="rect" href="classcbdc_1_1locking__shard_1_1status__interface.html" title="Interface for querying the read&#45;only state of a locking shard." alt="" coords="165,5,301,47"/>
</map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for cbdc::locking_shard::locking_shard:</div>
<div class="dyncontent">
<div class="center"><img src="classcbdc_1_1locking__shard_1_1locking__shard__coll__graph.png" border="0" usemap="#acbdc_1_1locking__shard_1_1locking__shard_coll__map" alt="Collaboration graph"/></div>
<map name="acbdc_1_1locking__shard_1_1locking__shard_coll__map" id="acbdc_1_1locking__shard_1_1locking__shard_coll__map">
<area shape="rect" title="In&#45;memory implementation of interface and status_interface." alt="" coords="85,95,221,136"/>
<area shape="rect" href="classcbdc_1_1locking__shard_1_1interface.html" title="Interface for a locking shard." alt="" coords="5,5,141,47"/>
<area shape="rect" href="classcbdc_1_1locking__shard_1_1status__interface.html" title="Interface for querying the read&#45;only state of a locking shard." alt="" coords="165,5,301,47"/>
</map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:aacfd625cc8cc8e9d47d65b98ee0c225b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcbdc_1_1locking__shard_1_1locking__shard.html#aacfd625cc8cc8e9d47d65b98ee0c225b">locking_shard</a> (const std::pair&lt; uint8_t, uint8_t &gt; &amp;output_range, std::shared_ptr&lt; <a class="el" href="classcbdc_1_1logging_1_1log.html">logging::log</a> &gt; logger, size_t completed_txs_cache_size, const std::string &amp;preseed_file)</td></tr>
<tr class="memdesc:aacfd625cc8cc8e9d47d65b98ee0c225b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="classcbdc_1_1locking__shard_1_1locking__shard.html#aacfd625cc8cc8e9d47d65b98ee0c225b">More...</a><br /></td></tr>
<tr class="separator:aacfd625cc8cc8e9d47d65b98ee0c225b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a628716825a4c20daf36a207c69ccb1fa"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcbdc_1_1locking__shard_1_1locking__shard.html#a628716825a4c20daf36a207c69ccb1fa">locking_shard</a> ()=delete</td></tr>
<tr class="separator:a628716825a4c20daf36a207c69ccb1fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2191dfca19425c15e6757b7380478dc1"><td class="memItemLeft" align="right" valign="top">auto&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcbdc_1_1locking__shard_1_1locking__shard.html#a2191dfca19425c15e6757b7380478dc1">lock_outputs</a> (std::vector&lt; <a class="el" href="structcbdc_1_1locking__shard_1_1tx.html">tx</a> &gt; &amp;&amp;txs, const <a class="el" href="namespacecbdc.html#ae259dc3000a4487dd87a2ee9662ba73e">hash_t</a> &amp;dtx_id) -&gt; std::optional&lt; std::vector&lt; bool &gt; &gt; final</td></tr>
<tr class="memdesc:a2191dfca19425c15e6757b7380478dc1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Attempts to lock the input hashes for the given batch of transactions.  <a href="classcbdc_1_1locking__shard_1_1locking__shard.html#a2191dfca19425c15e6757b7380478dc1">More...</a><br /></td></tr>
<tr class="separator:a2191dfca19425c15e6757b7380478dc1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1411ffc31504533ad3d3983824bc7561"><td class="memItemLeft" align="right" valign="top">auto&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcbdc_1_1locking__shard_1_1locking__shard.html#a1411ffc31504533ad3d3983824bc7561">apply_outputs</a> (std::vector&lt; bool &gt; &amp;&amp;complete_txs, const <a class="el" href="namespacecbdc.html#ae259dc3000a4487dd87a2ee9662ba73e">hash_t</a> &amp;dtx_id) -&gt; bool final</td></tr>
<tr class="memdesc:a1411ffc31504533ad3d3983824bc7561"><td class="mdescLeft">&#160;</td><td class="mdescRight">Selectively applies the transactions from a previous lock operation.  <a href="classcbdc_1_1locking__shard_1_1locking__shard.html#a1411ffc31504533ad3d3983824bc7561">More...</a><br /></td></tr>
<tr class="separator:a1411ffc31504533ad3d3983824bc7561"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab5c383c7b408e7b4c28b95065d23405c"><td class="memItemLeft" align="right" valign="top">auto&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcbdc_1_1locking__shard_1_1locking__shard.html#ab5c383c7b408e7b4c28b95065d23405c">discard_dtx</a> (const <a class="el" href="namespacecbdc.html#ae259dc3000a4487dd87a2ee9662ba73e">hash_t</a> &amp;dtx_id) -&gt; bool final</td></tr>
<tr class="memdesc:ab5c383c7b408e7b4c28b95065d23405c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Discards any cached information about a given distributed transaction.  <a href="classcbdc_1_1locking__shard_1_1locking__shard.html#ab5c383c7b408e7b4c28b95065d23405c">More...</a><br /></td></tr>
<tr class="separator:ab5c383c7b408e7b4c28b95065d23405c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad56791cbe673b6f1b3c76b27f26a7c84"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcbdc_1_1locking__shard_1_1locking__shard.html#ad56791cbe673b6f1b3c76b27f26a7c84">stop</a> () final</td></tr>
<tr class="memdesc:ad56791cbe673b6f1b3c76b27f26a7c84"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stops the locking shard from processing further commands.  <a href="classcbdc_1_1locking__shard_1_1locking__shard.html#ad56791cbe673b6f1b3c76b27f26a7c84">More...</a><br /></td></tr>
<tr class="separator:ad56791cbe673b6f1b3c76b27f26a7c84"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb86f8429f49b274b0b836af7bee298f"><td class="memItemLeft" align="right" valign="top">auto&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcbdc_1_1locking__shard_1_1locking__shard.html#aeb86f8429f49b274b0b836af7bee298f">check_unspent</a> (const <a class="el" href="namespacecbdc.html#ae259dc3000a4487dd87a2ee9662ba73e">hash_t</a> &amp;uhs_id) -&gt; std::optional&lt; bool &gt; final</td></tr>
<tr class="memdesc:aeb86f8429f49b274b0b836af7bee298f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Queries whether the shard's UHS contains the given UHS ID.  <a href="classcbdc_1_1locking__shard_1_1locking__shard.html#aeb86f8429f49b274b0b836af7bee298f">More...</a><br /></td></tr>
<tr class="separator:aeb86f8429f49b274b0b836af7bee298f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a863081e03ef42b863c29935d98e396a6"><td class="memItemLeft" align="right" valign="top">auto&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcbdc_1_1locking__shard_1_1locking__shard.html#a863081e03ef42b863c29935d98e396a6">check_tx_id</a> (const <a class="el" href="namespacecbdc.html#ae259dc3000a4487dd87a2ee9662ba73e">hash_t</a> &amp;tx_id) -&gt; std::optional&lt; bool &gt; final</td></tr>
<tr class="memdesc:a863081e03ef42b863c29935d98e396a6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Queries whether the given TX ID is confirmed in the cache of recently confirmed TX IDs.  <a href="classcbdc_1_1locking__shard_1_1locking__shard.html#a863081e03ef42b863c29935d98e396a6">More...</a><br /></td></tr>
<tr class="separator:a863081e03ef42b863c29935d98e396a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classcbdc_1_1locking__shard_1_1interface"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classcbdc_1_1locking__shard_1_1interface')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classcbdc_1_1locking__shard_1_1interface.html">cbdc::locking_shard::interface</a></td></tr>
<tr class="memitem:a9d12fbd7c2d47697899899fa3d8e83a6 inherit pub_methods_classcbdc_1_1locking__shard_1_1interface"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcbdc_1_1locking__shard_1_1interface.html#a9d12fbd7c2d47697899899fa3d8e83a6">interface</a> (std::pair&lt; uint8_t, uint8_t &gt; output_range)</td></tr>
<tr class="memdesc:a9d12fbd7c2d47697899899fa3d8e83a6 inherit pub_methods_classcbdc_1_1locking__shard_1_1interface"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="classcbdc_1_1locking__shard_1_1interface.html#a9d12fbd7c2d47697899899fa3d8e83a6">More...</a><br /></td></tr>
<tr class="separator:a9d12fbd7c2d47697899899fa3d8e83a6 inherit pub_methods_classcbdc_1_1locking__shard_1_1interface"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab79b615c925f73b29cc26f9a10b796af inherit pub_methods_classcbdc_1_1locking__shard_1_1interface"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcbdc_1_1locking__shard_1_1interface.html#ab79b615c925f73b29cc26f9a10b796af">~interface</a> ()=default</td></tr>
<tr class="separator:ab79b615c925f73b29cc26f9a10b796af inherit pub_methods_classcbdc_1_1locking__shard_1_1interface"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a858a0076a483d93700ad81905e3131ad inherit pub_methods_classcbdc_1_1locking__shard_1_1interface"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcbdc_1_1locking__shard_1_1interface.html#a858a0076a483d93700ad81905e3131ad">interface</a> ()=delete</td></tr>
<tr class="separator:a858a0076a483d93700ad81905e3131ad inherit pub_methods_classcbdc_1_1locking__shard_1_1interface"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0a6dd5414b4822a1fe0111d4ed74b32 inherit pub_methods_classcbdc_1_1locking__shard_1_1interface"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcbdc_1_1locking__shard_1_1interface.html#ac0a6dd5414b4822a1fe0111d4ed74b32">interface</a> (const <a class="el" href="classcbdc_1_1locking__shard_1_1interface.html">interface</a> &amp;)=delete</td></tr>
<tr class="separator:ac0a6dd5414b4822a1fe0111d4ed74b32 inherit pub_methods_classcbdc_1_1locking__shard_1_1interface"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a941a6e37422849663eb3be5bb95b7f5f inherit pub_methods_classcbdc_1_1locking__shard_1_1interface"><td class="memItemLeft" align="right" valign="top">auto&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcbdc_1_1locking__shard_1_1interface.html#a941a6e37422849663eb3be5bb95b7f5f">operator=</a> (const <a class="el" href="classcbdc_1_1locking__shard_1_1interface.html">interface</a> &amp;) -&gt; <a class="el" href="classcbdc_1_1locking__shard_1_1interface.html">interface</a> &amp;=delete</td></tr>
<tr class="separator:a941a6e37422849663eb3be5bb95b7f5f inherit pub_methods_classcbdc_1_1locking__shard_1_1interface"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a2c3e027235f35a5242e966e9a36466 inherit pub_methods_classcbdc_1_1locking__shard_1_1interface"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcbdc_1_1locking__shard_1_1interface.html#a7a2c3e027235f35a5242e966e9a36466">interface</a> (<a class="el" href="classcbdc_1_1locking__shard_1_1interface.html">interface</a> &amp;&amp;)=delete</td></tr>
<tr class="separator:a7a2c3e027235f35a5242e966e9a36466 inherit pub_methods_classcbdc_1_1locking__shard_1_1interface"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a58949e7cfab91db8dd70024dfd11fb80 inherit pub_methods_classcbdc_1_1locking__shard_1_1interface"><td class="memItemLeft" align="right" valign="top">auto&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcbdc_1_1locking__shard_1_1interface.html#a58949e7cfab91db8dd70024dfd11fb80">operator=</a> (<a class="el" href="classcbdc_1_1locking__shard_1_1interface.html">interface</a> &amp;&amp;) -&gt; <a class="el" href="classcbdc_1_1locking__shard_1_1interface.html">interface</a> &amp;=delete</td></tr>
<tr class="separator:a58949e7cfab91db8dd70024dfd11fb80 inherit pub_methods_classcbdc_1_1locking__shard_1_1interface"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a69530d653511232ccd555b3c64a8816f inherit pub_methods_classcbdc_1_1locking__shard_1_1interface"><td class="memItemLeft" align="right" valign="top">virtual auto&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcbdc_1_1locking__shard_1_1interface.html#a69530d653511232ccd555b3c64a8816f">lock_outputs</a> (std::vector&lt; <a class="el" href="structcbdc_1_1locking__shard_1_1tx.html">tx</a> &gt; &amp;&amp;txs, const <a class="el" href="namespacecbdc.html#ae259dc3000a4487dd87a2ee9662ba73e">hash_t</a> &amp;dtx_id) -&gt; std::optional&lt; std::vector&lt; bool &gt; &gt;=0</td></tr>
<tr class="memdesc:a69530d653511232ccd555b3c64a8816f inherit pub_methods_classcbdc_1_1locking__shard_1_1interface"><td class="mdescLeft">&#160;</td><td class="mdescRight">Attempts to lock the input hashes for the given vector of transactions.  <a href="classcbdc_1_1locking__shard_1_1interface.html#a69530d653511232ccd555b3c64a8816f">More...</a><br /></td></tr>
<tr class="separator:a69530d653511232ccd555b3c64a8816f inherit pub_methods_classcbdc_1_1locking__shard_1_1interface"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82f829303340136010761d13c47656d8 inherit pub_methods_classcbdc_1_1locking__shard_1_1interface"><td class="memItemLeft" align="right" valign="top">virtual auto&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcbdc_1_1locking__shard_1_1interface.html#a82f829303340136010761d13c47656d8">apply_outputs</a> (std::vector&lt; bool &gt; &amp;&amp;complete_txs, const <a class="el" href="namespacecbdc.html#ae259dc3000a4487dd87a2ee9662ba73e">hash_t</a> &amp;dtx_id) -&gt; bool=0</td></tr>
<tr class="memdesc:a82f829303340136010761d13c47656d8 inherit pub_methods_classcbdc_1_1locking__shard_1_1interface"><td class="mdescLeft">&#160;</td><td class="mdescRight">Completes a previous lock operation by deleting input hashes and creating output hashes, or unlocking input hashes.  <a href="classcbdc_1_1locking__shard_1_1interface.html#a82f829303340136010761d13c47656d8">More...</a><br /></td></tr>
<tr class="separator:a82f829303340136010761d13c47656d8 inherit pub_methods_classcbdc_1_1locking__shard_1_1interface"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa78994bd1065a26aa813e9b62ba9031 inherit pub_methods_classcbdc_1_1locking__shard_1_1interface"><td class="memItemLeft" align="right" valign="top">virtual auto&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcbdc_1_1locking__shard_1_1interface.html#afa78994bd1065a26aa813e9b62ba9031">hash_in_shard_range</a> (const <a class="el" href="namespacecbdc.html#ae259dc3000a4487dd87a2ee9662ba73e">hash_t</a> &amp;h) const -&gt; bool</td></tr>
<tr class="memdesc:afa78994bd1065a26aa813e9b62ba9031 inherit pub_methods_classcbdc_1_1locking__shard_1_1interface"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns whether a given hash is within the shard's range.  <a href="classcbdc_1_1locking__shard_1_1interface.html#afa78994bd1065a26aa813e9b62ba9031">More...</a><br /></td></tr>
<tr class="separator:afa78994bd1065a26aa813e9b62ba9031 inherit pub_methods_classcbdc_1_1locking__shard_1_1interface"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af10f56392a3607301847e306c10fa5fe inherit pub_methods_classcbdc_1_1locking__shard_1_1interface"><td class="memItemLeft" align="right" valign="top">virtual auto&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcbdc_1_1locking__shard_1_1interface.html#af10f56392a3607301847e306c10fa5fe">discard_dtx</a> (const <a class="el" href="namespacecbdc.html#ae259dc3000a4487dd87a2ee9662ba73e">hash_t</a> &amp;dtx_id) -&gt; bool=0</td></tr>
<tr class="memdesc:af10f56392a3607301847e306c10fa5fe inherit pub_methods_classcbdc_1_1locking__shard_1_1interface"><td class="mdescLeft">&#160;</td><td class="mdescRight">Discards any cached information about a given distributed transaction.  <a href="classcbdc_1_1locking__shard_1_1interface.html#af10f56392a3607301847e306c10fa5fe">More...</a><br /></td></tr>
<tr class="separator:af10f56392a3607301847e306c10fa5fe inherit pub_methods_classcbdc_1_1locking__shard_1_1interface"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3658bb9429371d57a7ad5d211727aa1a inherit pub_methods_classcbdc_1_1locking__shard_1_1interface"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcbdc_1_1locking__shard_1_1interface.html#a3658bb9429371d57a7ad5d211727aa1a">stop</a> ()=0</td></tr>
<tr class="memdesc:a3658bb9429371d57a7ad5d211727aa1a inherit pub_methods_classcbdc_1_1locking__shard_1_1interface"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stops the locking shard implementation from processing further commands and unblocks any pending commands.  <a href="classcbdc_1_1locking__shard_1_1interface.html#a3658bb9429371d57a7ad5d211727aa1a">More...</a><br /></td></tr>
<tr class="separator:a3658bb9429371d57a7ad5d211727aa1a inherit pub_methods_classcbdc_1_1locking__shard_1_1interface"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classcbdc_1_1locking__shard_1_1status__interface"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classcbdc_1_1locking__shard_1_1status__interface')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classcbdc_1_1locking__shard_1_1status__interface.html">cbdc::locking_shard::status_interface</a></td></tr>
<tr class="memitem:aa26de6b0dbc2c46a9823713f9b43cdab inherit pub_methods_classcbdc_1_1locking__shard_1_1status__interface"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcbdc_1_1locking__shard_1_1status__interface.html#aa26de6b0dbc2c46a9823713f9b43cdab">status_interface</a> ()=default</td></tr>
<tr class="separator:aa26de6b0dbc2c46a9823713f9b43cdab inherit pub_methods_classcbdc_1_1locking__shard_1_1status__interface"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a310e89769c7e04c799e462f2c30648d4 inherit pub_methods_classcbdc_1_1locking__shard_1_1status__interface"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcbdc_1_1locking__shard_1_1status__interface.html#a310e89769c7e04c799e462f2c30648d4">~status_interface</a> ()=default</td></tr>
<tr class="separator:a310e89769c7e04c799e462f2c30648d4 inherit pub_methods_classcbdc_1_1locking__shard_1_1status__interface"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa608b8b6f5568e1947796f712bed987a inherit pub_methods_classcbdc_1_1locking__shard_1_1status__interface"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcbdc_1_1locking__shard_1_1status__interface.html#aa608b8b6f5568e1947796f712bed987a">status_interface</a> (const <a class="el" href="classcbdc_1_1locking__shard_1_1status__interface.html">status_interface</a> &amp;)=default</td></tr>
<tr class="separator:aa608b8b6f5568e1947796f712bed987a inherit pub_methods_classcbdc_1_1locking__shard_1_1status__interface"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a570ab2790548f120be6e78543307899e inherit pub_methods_classcbdc_1_1locking__shard_1_1status__interface"><td class="memItemLeft" align="right" valign="top">auto&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcbdc_1_1locking__shard_1_1status__interface.html#a570ab2790548f120be6e78543307899e">operator=</a> (const <a class="el" href="classcbdc_1_1locking__shard_1_1status__interface.html">status_interface</a> &amp;) -&gt; <a class="el" href="classcbdc_1_1locking__shard_1_1status__interface.html">status_interface</a> &amp;=default</td></tr>
<tr class="separator:a570ab2790548f120be6e78543307899e inherit pub_methods_classcbdc_1_1locking__shard_1_1status__interface"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ce49c301a3c8834a7f493abcd0040e6 inherit pub_methods_classcbdc_1_1locking__shard_1_1status__interface"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcbdc_1_1locking__shard_1_1status__interface.html#a2ce49c301a3c8834a7f493abcd0040e6">status_interface</a> (<a class="el" href="classcbdc_1_1locking__shard_1_1status__interface.html">status_interface</a> &amp;&amp;)=default</td></tr>
<tr class="separator:a2ce49c301a3c8834a7f493abcd0040e6 inherit pub_methods_classcbdc_1_1locking__shard_1_1status__interface"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af6690258590551ba877245655bff2942 inherit pub_methods_classcbdc_1_1locking__shard_1_1status__interface"><td class="memItemLeft" align="right" valign="top">auto&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcbdc_1_1locking__shard_1_1status__interface.html#af6690258590551ba877245655bff2942">operator=</a> (<a class="el" href="classcbdc_1_1locking__shard_1_1status__interface.html">status_interface</a> &amp;&amp;) -&gt; <a class="el" href="classcbdc_1_1locking__shard_1_1status__interface.html">status_interface</a> &amp;=default</td></tr>
<tr class="separator:af6690258590551ba877245655bff2942 inherit pub_methods_classcbdc_1_1locking__shard_1_1status__interface"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31614f8e5d3d193b6f438a37daf38b60 inherit pub_methods_classcbdc_1_1locking__shard_1_1status__interface"><td class="memItemLeft" align="right" valign="top">virtual auto&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcbdc_1_1locking__shard_1_1status__interface.html#a31614f8e5d3d193b6f438a37daf38b60">check_unspent</a> (const <a class="el" href="namespacecbdc.html#ae259dc3000a4487dd87a2ee9662ba73e">hash_t</a> &amp;uhs_id) -&gt; std::optional&lt; bool &gt;=0</td></tr>
<tr class="memdesc:a31614f8e5d3d193b6f438a37daf38b60 inherit pub_methods_classcbdc_1_1locking__shard_1_1status__interface"><td class="mdescLeft">&#160;</td><td class="mdescRight">Queries whether the shard's UHS contains the given UHS ID.  <a href="classcbdc_1_1locking__shard_1_1status__interface.html#a31614f8e5d3d193b6f438a37daf38b60">More...</a><br /></td></tr>
<tr class="separator:a31614f8e5d3d193b6f438a37daf38b60 inherit pub_methods_classcbdc_1_1locking__shard_1_1status__interface"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa679af1d725dfba3c93589f464876fa inherit pub_methods_classcbdc_1_1locking__shard_1_1status__interface"><td class="memItemLeft" align="right" valign="top">virtual auto&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcbdc_1_1locking__shard_1_1status__interface.html#afa679af1d725dfba3c93589f464876fa">check_tx_id</a> (const <a class="el" href="namespacecbdc.html#ae259dc3000a4487dd87a2ee9662ba73e">hash_t</a> &amp;tx_id) -&gt; std::optional&lt; bool &gt;=0</td></tr>
<tr class="memdesc:afa679af1d725dfba3c93589f464876fa inherit pub_methods_classcbdc_1_1locking__shard_1_1status__interface"><td class="mdescLeft">&#160;</td><td class="mdescRight">Queries whether the given TX ID is confirmed in the cache of recently confirmed TX IDs.  <a href="classcbdc_1_1locking__shard_1_1status__interface.html#afa679af1d725dfba3c93589f464876fa">More...</a><br /></td></tr>
<tr class="separator:afa679af1d725dfba3c93589f464876fa inherit pub_methods_classcbdc_1_1locking__shard_1_1status__interface"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >In-memory implementation of <a class="el" href="classcbdc_1_1locking__shard_1_1interface.html">interface</a> and <a class="el" href="classcbdc_1_1locking__shard_1_1status__interface.html">status_interface</a>. </p>
<dl class="section warning"><dt>Warning</dt><dd>Not thread safe. Implements a UHS through conservative two-phase locking. Callers atomically check a batch of prospective transactions for spendable input UHS IDs in this shard's range, and lock those UHS IDs. Based on confirming responses from other shards, callers specify which transactions to complete and which to abort. Shards use a unique batch ID to track each batch across lock and apply (completion) operations to allow for parallel batch processing. The completed transactions cache allows users to determine whether a given transaction ID has been recently applied in the system. This is useful for recipients in a transaction to verify that the transaction has completed, or if the sender disconnects from the sentinel before receiving a response. </dd></dl>

<p class="definition">Definition at line <a class="el" href="locking__shard_8hpp_source.html#l00044">44</a> of file <a class="el" href="locking__shard_8hpp_source.html">locking_shard.hpp</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="aacfd625cc8cc8e9d47d65b98ee0c225b" name="aacfd625cc8cc8e9d47d65b98ee0c225b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aacfd625cc8cc8e9d47d65b98ee0c225b">&#9670;&nbsp;</a></span>locking_shard() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">cbdc::locking_shard::locking_shard::locking_shard </td>
          <td>(</td>
          <td class="paramtype">const std::pair&lt; uint8_t, uint8_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>output_range</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::shared_ptr&lt; <a class="el" href="classcbdc_1_1logging_1_1log.html">logging::log</a> &gt;&#160;</td>
          <td class="paramname"><em>logger</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>completed_txs_cache_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>preseed_file</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">output_range</td><td>inclusive range of hash prefixes this shard is responsible for. </td></tr>
    <tr><td class="paramname">logger</td><td>log instance. </td></tr>
    <tr><td class="paramname">completed_txs_cache_size</td><td>number of confirmed TX IDs to keep before evicting the oldest TX ID. </td></tr>
    <tr><td class="paramname">preseed_file</td><td>path to file containing shard pre-seeding data or empty string to disable pre-seeding. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="locking__shard_8cpp_source.html#l00023">23</a> of file <a class="el" href="locking__shard_8cpp_source.html">locking_shard.cpp</a>.</p>

</div>
</div>
<a id="a628716825a4c20daf36a207c69ccb1fa" name="a628716825a4c20daf36a207c69ccb1fa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a628716825a4c20daf36a207c69ccb1fa">&#9670;&nbsp;</a></span>locking_shard() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">cbdc::locking_shard::locking_shard::locking_shard </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">delete</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a1411ffc31504533ad3d3983824bc7561" name="a1411ffc31504533ad3d3983824bc7561"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1411ffc31504533ad3d3983824bc7561">&#9670;&nbsp;</a></span>apply_outputs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">auto cbdc::locking_shard::locking_shard::apply_outputs </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; bool &gt; &amp;&amp;&#160;</td>
          <td class="paramname"><em>complete_txs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacecbdc.html#ae259dc3000a4487dd87a2ee9662ba73e">hash_t</a> &amp;&#160;</td>
          <td class="paramname"><em>dtx_id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> -&gt; bool</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">final</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Selectively applies the transactions from a previous lock operation. </p>
<p >Follows confirmation from other shards via the coordinator. Completes a previous lock operation by deleting the input hashes and adding the output hashes of confirmed transactions, and unlocking the input hashes of aborted transactions. Preceded by a lock operation with the same dtx_id. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">complete_txs</td><td>vector of truth values indicating which txs from the previous lock operation the shard should apply (<code>true</code>), and which it should cancel (<code>false</code>). Must have the same size and Â  order as txs from lock. </td></tr>
    <tr><td class="paramname">dtx_id</td><td>distributed transaction ID of the previous lock operation. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if the apply operation succeeded. </dd></dl>

<p>Implements <a class="el" href="classcbdc_1_1locking__shard_1_1interface.html#a82f829303340136010761d13c47656d8">cbdc::locking_shard::interface</a>.</p>

<p class="definition">Definition at line <a class="el" href="locking__shard_8cpp_source.html#l00115">115</a> of file <a class="el" href="locking__shard_8cpp_source.html">locking_shard.cpp</a>.</p>

<p class="reference">References <a class="el" href="config_8cpp_source.html#l00684">cbdc::config::hash_in_shard_range()</a>, <a class="el" href="twophase_2locking__shard_2interface_8hpp_source.html#l00023">cbdc::locking_shard::tx::m_creating</a>, <a class="el" href="twophase_2locking__shard_2interface_8hpp_source.html#l00021">cbdc::locking_shard::tx::m_spending</a>, <a class="el" href="twophase_2locking__shard_2interface_8hpp_source.html#l00019">cbdc::locking_shard::tx::m_tx_id</a>, and <a class="el" href="hash_8cpp_source.html#l00015">cbdc::to_string()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcbdc_1_1locking__shard_1_1locking__shard_a1411ffc31504533ad3d3983824bc7561_cgraph.png" border="0" usemap="#aclasscbdc_1_1locking__shard_1_1locking__shard_a1411ffc31504533ad3d3983824bc7561_cgraph" alt=""/></div>
<map name="aclasscbdc_1_1locking__shard_1_1locking__shard_a1411ffc31504533ad3d3983824bc7561_cgraph" id="aclasscbdc_1_1locking__shard_1_1locking__shard_a1411ffc31504533ad3d3983824bc7561_cgraph">
<area shape="rect" title="Selectively applies the transactions from a previous lock operation." alt="" coords="5,27,149,83"/>
<area shape="rect" href="namespacecbdc_1_1config.html#accbad9a301a3d8a1921e60b9a756954e" title="Checks if a hash is in the given range handled." alt="" coords="197,5,321,47"/>
<area shape="rect" href="namespacecbdc.html#aeca0663c5237402736e3127369854cb5" title="Converts a hash to a hexadecimal string." alt="" coords="206,71,313,98"/>
</map>
</div>

</div>
</div>
<a id="a863081e03ef42b863c29935d98e396a6" name="a863081e03ef42b863c29935d98e396a6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a863081e03ef42b863c29935d98e396a6">&#9670;&nbsp;</a></span>check_tx_id()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">auto cbdc::locking_shard::locking_shard::check_tx_id </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespacecbdc.html#ae259dc3000a4487dd87a2ee9662ba73e">hash_t</a> &amp;&#160;</td>
          <td class="paramname"><em>tx_id</em></td><td>)</td>
          <td> -&gt; std::optional&lt;bool&gt;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">final</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Queries whether the given TX ID is confirmed in the cache of recently confirmed TX IDs. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tx_id</td><td>TX ID to query. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if cache contains TX ID, or false if not. std::nullopt if the query failed. </dd></dl>

<p>Implements <a class="el" href="classcbdc_1_1locking__shard_1_1status__interface.html#afa679af1d725dfba3c93589f464876fa">cbdc::locking_shard::status_interface</a>.</p>

<p class="definition">Definition at line <a class="el" href="locking__shard_8cpp_source.html#l00175">175</a> of file <a class="el" href="locking__shard_8cpp_source.html">locking_shard.cpp</a>.</p>

<p class="reference">References <a class="el" href="transaction_8cpp_source.html#l00068">cbdc::transaction::tx_id()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcbdc_1_1locking__shard_1_1locking__shard_a863081e03ef42b863c29935d98e396a6_cgraph.png" border="0" usemap="#aclasscbdc_1_1locking__shard_1_1locking__shard_a863081e03ef42b863c29935d98e396a6_cgraph" alt=""/></div>
<map name="aclasscbdc_1_1locking__shard_1_1locking__shard_a863081e03ef42b863c29935d98e396a6_cgraph" id="aclasscbdc_1_1locking__shard_1_1locking__shard_a863081e03ef42b863c29935d98e396a6_cgraph">
<area shape="rect" title="Queries whether the given TX ID is confirmed in the cache of recently confirmed TX IDs." alt="" coords="5,5,188,47"/>
<area shape="rect" href="namespacecbdc_1_1transaction.html#a43a4b189920471ef5363e91bc908a892" title="Calculates the unique hash of a full transaction." alt="" coords="236,5,363,47"/>
<area shape="rect" href="namespacecbdc.html#aed9c6313b2ae6e3d7f01340ab5a3076b" title="Serialize object into nuraft::buffer using a cbdc::nuraft_serializer." alt="" coords="411,13,537,39"/>
<area shape="rect" href="namespacecbdc.html#a4dd685b58c8cf66f4489ab808915ab85" title="Calculates the serialized size in bytes of the given object when serialized using serializer." alt="" coords="585,13,725,39"/>
</map>
</div>

</div>
</div>
<a id="aeb86f8429f49b274b0b836af7bee298f" name="aeb86f8429f49b274b0b836af7bee298f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb86f8429f49b274b0b836af7bee298f">&#9670;&nbsp;</a></span>check_unspent()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">auto cbdc::locking_shard::locking_shard::check_unspent </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespacecbdc.html#ae259dc3000a4487dd87a2ee9662ba73e">hash_t</a> &amp;&#160;</td>
          <td class="paramname"><em>uhs_id</em></td><td>)</td>
          <td> -&gt; std::optional&lt;bool&gt;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">final</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Queries whether the shard's UHS contains the given UHS ID. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">uhs_id</td><td>UHS ID to query. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if the UHS ID is unspent, false if not. std::nullopt if the query failed. </dd></dl>

<p>Implements <a class="el" href="classcbdc_1_1locking__shard_1_1status__interface.html#a31614f8e5d3d193b6f438a37daf38b60">cbdc::locking_shard::status_interface</a>.</p>

<p class="definition">Definition at line <a class="el" href="locking__shard_8cpp_source.html#l00168">168</a> of file <a class="el" href="locking__shard_8cpp_source.html">locking_shard.cpp</a>.</p>

</div>
</div>
<a id="ab5c383c7b408e7b4c28b95065d23405c" name="ab5c383c7b408e7b4c28b95065d23405c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab5c383c7b408e7b4c28b95065d23405c">&#9670;&nbsp;</a></span>discard_dtx()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">auto cbdc::locking_shard::locking_shard::discard_dtx </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespacecbdc.html#ae259dc3000a4487dd87a2ee9662ba73e">hash_t</a> &amp;&#160;</td>
          <td class="paramname"><em>dtx_id</em></td><td>)</td>
          <td> -&gt; bool</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">final</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Discards any cached information about a given distributed transaction. </p>
<p >Called as the final step of a distributed transaction once all other participating shards have finished processing <a class="el" href="classcbdc_1_1locking__shard_1_1locking__shard.html#a1411ffc31504533ad3d3983824bc7561">apply_outputs</a>. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dtx_id</td><td>distributed transaction ID of a previous apply command. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if the discard operation succeeded. </dd></dl>

<p>Implements <a class="el" href="classcbdc_1_1locking__shard_1_1interface.html#af10f56392a3607301847e306c10fa5fe">cbdc::locking_shard::interface</a>.</p>

<p class="definition">Definition at line <a class="el" href="locking__shard_8cpp_source.html#l00014">14</a> of file <a class="el" href="locking__shard_8cpp_source.html">locking_shard.cpp</a>.</p>

</div>
</div>
<a id="a2191dfca19425c15e6757b7380478dc1" name="a2191dfca19425c15e6757b7380478dc1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2191dfca19425c15e6757b7380478dc1">&#9670;&nbsp;</a></span>lock_outputs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">auto cbdc::locking_shard::locking_shard::lock_outputs </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; <a class="el" href="structcbdc_1_1locking__shard_1_1tx.html">tx</a> &gt; &amp;&amp;&#160;</td>
          <td class="paramname"><em>txs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacecbdc.html#ae259dc3000a4487dd87a2ee9662ba73e">hash_t</a> &amp;&#160;</td>
          <td class="paramname"><em>dtx_id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> -&gt; std::optional&lt;std::vector&lt;bool&gt;&gt;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">final</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Attempts to lock the input hashes for the given batch of transactions. </p>
<p >Only considers input hashes within this shard's range. The batch of transactions is a single distributed transaction, or 'dtx'. The coordinator that communicates with instances of this class provides a globally unique dtx ID along for each dtx. The provided vector of transactions may be a subset of the overall batch only including transactions relevant to this shard. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">txs</td><td>list of txs to attempt to lock. </td></tr>
    <tr><td class="paramname">dtx_id</td><td>distributed tx ID for lock operation. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>if lock succeeds, return a vector of flags corresponding to the txs in the input which had their relevant input hashes locked by the shard. Otherwise std::nullopt. </dd></dl>

<p>Implements <a class="el" href="classcbdc_1_1locking__shard_1_1interface.html#a69530d653511232ccd555b3c64a8816f">cbdc::locking_shard::interface</a>.</p>

<p class="definition">Definition at line <a class="el" href="locking__shard_8cpp_source.html#l00075">75</a> of file <a class="el" href="locking__shard_8cpp_source.html">locking_shard.cpp</a>.</p>

<p class="reference">References <a class="el" href="config_8cpp_source.html#l00684">cbdc::config::hash_in_shard_range()</a>, and <a class="el" href="twophase_2locking__shard_2interface_8hpp_source.html#l00021">cbdc::locking_shard::tx::m_spending</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcbdc_1_1locking__shard_1_1locking__shard_a2191dfca19425c15e6757b7380478dc1_cgraph.png" border="0" usemap="#aclasscbdc_1_1locking__shard_1_1locking__shard_a2191dfca19425c15e6757b7380478dc1_cgraph" alt=""/></div>
<map name="aclasscbdc_1_1locking__shard_1_1locking__shard_a2191dfca19425c15e6757b7380478dc1_cgraph" id="aclasscbdc_1_1locking__shard_1_1locking__shard_a2191dfca19425c15e6757b7380478dc1_cgraph">
<area shape="rect" title="Attempts to lock the input hashes for the given batch of transactions." alt="" coords="5,5,144,61"/>
<area shape="rect" href="namespacecbdc_1_1config.html#accbad9a301a3d8a1921e60b9a756954e" title="Checks if a hash is in the given range handled." alt="" coords="192,13,316,54"/>
</map>
</div>

</div>
</div>
<a id="ad56791cbe673b6f1b3c76b27f26a7c84" name="ad56791cbe673b6f1b3c76b27f26a7c84"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad56791cbe673b6f1b3c76b27f26a7c84">&#9670;&nbsp;</a></span>stop()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void cbdc::locking_shard::locking_shard::stop </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">final</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Stops the locking shard from processing further commands. </p>
<p >Any future calls to methods of this class will return a failure result. </p>

<p>Implements <a class="el" href="classcbdc_1_1locking__shard_1_1interface.html#a3658bb9429371d57a7ad5d211727aa1a">cbdc::locking_shard::interface</a>.</p>

<p class="definition">Definition at line <a class="el" href="locking__shard_8cpp_source.html#l00164">164</a> of file <a class="el" href="locking__shard_8cpp_source.html">locking_shard.cpp</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="locking__shard_8hpp_source.html">locking_shard.hpp</a></li>
<li><a class="el" href="locking__shard_8cpp_source.html">locking_shard.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacecbdc.html">cbdc</a></li><li class="navelem"><a class="el" href="namespacecbdc_1_1locking__shard.html">locking_shard</a></li><li class="navelem"><a class="el" href="classcbdc_1_1locking__shard_1_1locking__shard.html">locking_shard</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3 </li>
  </ul>
</div>
</body>
</html>
